
<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="shortcut icon" href="../../assets/images/favicon.png">
      
      <meta name="generator" content="mkdocs-0.16.3, mkdocs-material-1.6.4">
    
    
      
        <title>Plugins - Geoladris</title>
      
    
    
      <script src="../../assets/javascripts/modernizr-1df76c4e58.js"></script>
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application-e2807e330f.css">
      
    
    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
  
  
  
    <body>
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <a href="../.." title="Geoladris" class="md-icon md-icon--home md-header-nav__button">
          </a>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Configuración
                </span>
              
            
            Plugins
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="Search" accesskey="s" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">close</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta" data-md-lang-result-none="No matching documents" data-md-lang-result-one="1 matching document" data-md-lang-result-other="# matching documents">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <div class="md-header-nav__source">
          
        </div>
      </div>
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    
      <i class="md-icon md-icon--home md-nav__button"></i>
    
    Geoladris
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Introducción
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Introducción
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../user_intro/user_intro/" title="Introducción" class="md-nav__link">
      Introducción
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user_intro/getting_involved/" title="Participación" class="md-nav__link">
      Participación
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user_intro/license/" title="Licencia" class="md-nav__link">
      Licencia
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Instalación
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Instalación
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/installation/" title="Instalación" class="md-nav__link">
      Instalación
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/project_structure/" title="Estructura del Proyecto" class="md-nav__link">
      Estructura del Proyecto
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/download/" title="Descargas" class="md-nav__link">
      Descargas
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Configuración
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Configuración
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../initial_config/" title="Configuración inicial" class="md-nav__link">
      Configuración inicial
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
    <a href="./" title="Plugins" class="md-nav__link md-nav__link--active">
      Plugins
    </a>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../migrating/" title="Migración de Versiones" class="md-nav__link">
      Migración de Versiones
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../user_deploy/" title="Usuario - Despliegue" class="md-nav__link">
      Usuario - Despliegue
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../user_guides/" title="Usuario - Tutoriales y guías" class="md-nav__link">
      Usuario - Tutoriales y guías
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../dev_plugins/" title="Desarrollador - Plugins" class="md-nav__link">
      Desarrollador - Plugins
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../dev_contrib/" title="Desarrollador - Contribuir" class="md-nav__link">
      Desarrollador - Contribuir
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../dev_tips/" title="Desarrollador - Consejos" class="md-nav__link">
      Desarrollador - Consejos
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../changelog/" title="Changelog" class="md-nav__link">
      Changelog
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="configuracion-de-los-plugins">Configuración de los plugins</h1>
<p>Como ya se ha comentado, Geoladris está preparado para modificar su comportamiento mediante la carga de plugins. Si se visualiza la <a href="../../installation/project_structure/">estructura del proyecto</a> se verá que la mayor parte de la funcionalidad se encuentra implementada mediante el desarrollo de plugins. A continuación se introduce la configuración de los diferentes plugins.</p>
<p>La configuración de los plugins se puede especificar de dos maneras diferentes: mediante <a href="#ficheros-json">ficheros</a> en el directorio de configuración o mediante una conexión a una <a href="#db">base de datos</a>.</p>
<p>En ambos casos, la configuración se especifica con un objeto JSON. Cada propiedad del objeto es el nombre del <em>plugin</em> a configurar y el valor es la configuración del plugin.</p>
<p>La configuración del plugin es a su vez otro objeto JSON. Cada propiedad es el nombre del módulo RequireJS a configurar y el valor es la configuración del módulo, tal y como se puede obtener con <code>module.config()</code>.</p>
<p>Aparte existen los siguientes psedo-módulos:</p>
<ul>
<li><code>_enabled</code>: Activa (<code>true</code>) o desactiva (<code>false</code>) el plugin. Por defecto es <code>true</code>.</li>
<li><code>_override</code>: Sobreescribe (<code>true</code>) o mezcla (<code>false</code>) la configuración por defecto del plugin. Por defecto es <code>false</code>.</li>
</ul>
<p>Ejemplo:</p>
<pre><code>    {
      &quot;base&quot; : {
        &quot;banner&quot; : {
          &quot;hide&quot; : true,
          &quot;show-flag&quot; : false,
          &quot;show-logos&quot; : false
        }
      },
      &quot;footnote&quot;: {
        &quot;footnote&quot;: {
          &quot;text&quot;: &quot;footnote.text&quot;,
          &quot;link&quot;: &quot;http://example.com&quot;,
          &quot;align&quot;: &quot;center&quot;
        }
      },
      &quot;feedback&quot;: {
        &quot;_enabled&quot; : false
      }
    }
</code></pre>

<p>De esta forma es posible no solo cambiar la configuración de un <em>plugin</em>, sino también añadir o eliminar <em>plugins</em> para un usuario concreto con el pseudomódulo <code>_enabled</code>.</p>
<p>Además es importante destacar que esta configuración pública o base puede ser adaptada en función del usuario que accede a la plataforma. Para ello, habrá que especificar un objeto JSON diferente por cada rol que pueda autenticarse en la aplicación. El formato de esos objetos JSON es el mismo que el descrito anteriormente.</p>
<p><strong>Nota</strong>: los usuarios y roles son gestionados por los <em>plugins</em>. Actualmente en Geoladris existe un plugin <code>auth</code> encargado de la autenticación.</p>
<p>En el Webinar de Programación se encuentra algunos ejemplos de configuración de plugins.
<a href="https://geoladris.github.io/webinar-programacion/programmer/#hola-geoladris">Ejemplo de Configuración de plugins</a></p>
<h2 id="ficheros-json"><a name="ficheros-json"></a>Ficheros <code>.json</code></h2>
<p>En el caso de configurar los plugins mediante ficheros, bastará con crear un fichero <code>public-conf.json</code> en el directorio de configuración, con el objeto JSON descrito en el apartado anterior-</p>
<p>Si además se desea adaptar la configuración en función del usuario , habrá que añadir ficheros <code>role_conf/&lt;rol&gt;.json</code> dentro del directorio de configuración. Cada uno de los ficheros contiene la configuración específica del rol del usuario. El contenido de los ficheros sigue el mismo formato que <code>public-conf.json</code>.</p>
<h2 id="base-de-datos"><a name="db"></a>Base de datos</h2>
<p>Para configurar los plugins desde una base de datos, dicha base de datos deberá tener una tabla <code>apps</code> con las siguientes columnas:</p>
<ul>
<li><code>app</code>: Nombre de la aplicación.</li>
<li><code>role</code>: Rol autenticado. El rol <code>default</code> está reservado para la configuración pública (análogo a <code>public-conf.json</code>).</li>
<li><code>conf</code>: Configuración de los plugins.</li>
</ul>
<pre><code>CREATE TABLE geoladris.apps (app text, role text, conf json NOT NULL,
  PRIMARY KEY(app, role));
</code></pre>

<p>También es posible configurar las propiedades y los mensajes de la aplicación desde la base de datos con las siguientes tablas:</p>
<pre><code>CREATE TABLE geoladris.props (app text, key text, value text NOT NULL,
  PRIMARY KEY(app, key));
CREATE TABLE geoladris.messages (app text, lang varchar(5), key text, value text NOT NULL,
  PRIMARY KEY(app, lang, key));
</code></pre>

<p>La conexión a la base de datos se obtiene de la siguiente manera:</p>
<ul>
<li>Se busca un <code>Resource</code> llamado <code>jdbc/geoladris</code> en <code>context.xml</code>.</li>
<li>Si no existe, se obtiene la conexión de las variables de entorno:</li>
<li><code>JDBC_CONNECTION_URL</code></li>
<li><code>JDBC_CONNECTION_USER</code></li>
<li><code>JDBC_CONNECTION_PASS</code></li>
<li><code>JDBC_CONNECTION_SCHEMA</code></li>
</ul>
<p>Si se ha obtenido una conexión válida, con una configuración por defecto (<code>SELECT conf FROM &lt;schema&gt;.apps WHERE app = '&lt;app&gt;' AND role = 'default'</code>), se utiliza dicha configuración. En caso contrario, se utilizan los <a href="#ficheros-json">ficheros .json</a>.</p>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../initial_config/" title="Configuración inicial" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Configuración inicial
              </span>
            </div>
          </a>
        
        
          <a href="../migrating/" title="Migración de Versiones" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Migración de Versiones
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application-06a3e72efd.js"></script>
      <script>app.initialize({url:{base:"../.."}})</script>
      
    
    
      
    
  </body>
</html>